# .env Refactoring Summary

## What Was Moved to `server/server_config.local.yaml`

All **non-secret configuration** has been moved to the YAML file:

### Moved Items (82 settings)

Dual connection system settings (MAX_CONNECTIONS_PER_PLAYER, CONNECTION_TIMEOUT, etc.)

- WebSocket configuration (WEBSOCKET_PING_INTERVAL, etc.)
- SSE configuration (SSE_RETRY_TIMEOUT, etc.)
- Session management settings
- Error handling configuration
- Performance monitoring settings
- CORS allowed origins/methods/headers
- Security headers (HSTS, CSP, Referrer-Policy)
- Performance tuning (WORKERS, MAX_REQUESTS, timeouts)
- Health check configuration
- Backup configuration
- Cache settings
- Monitoring flags (PROMETHEUS_ENABLED, GRAFANA_ENABLED, etc.)
- Load balancing settings
- Feature flags (ENABLE_* flags)
- File directories (ALIASES_DIR)
- Rate limiting configuration
- Logging rotation settings

## What Stays in `.env.local` (Secrets Only - 11 items)

```env
# --- Security Secrets (REQUIRED) ---

SECRET_KEY=dev-secret-key-change-this-in-production
MYTHOSMUD_ADMIN_PASSWORD=your_admin_password_here

# --- Database Override (OPTIONAL) ---
# DATABASE_URL=sqlite:///./data/players/local_players.db

# --- External Services (OPTIONAL) ---

SENTRY_DSN=
REDIS_URL=
SLACK_WEBHOOK_URL=

# --- Email Credentials (OPTIONAL) ---

EMAIL_SMTP_HOST=
EMAIL_SMTP_USER=
EMAIL_SMTP_PASSWORD=

# --- SSL/TLS Certificates (OPTIONAL) ---

SSL_CERT_PATH=
SSL_KEY_PATH=
```

## Key Principle

**YAML Config** (Committed to Git):
✅ Behavioral settings (how the server works)

✅ Limits and thresholds (rate limits, timeouts, pool sizes)

✅ Feature toggles (enable_combat, enable_weather)
- ✅ Non-sensitive paths (data directories, log locations)

**.env.local** (NEVER Committed):
✅ Passwords and secrets (admin password, secret keys)

✅ Service credentials (SMTP passwords, API keys)

✅ Environment-specific overrides (optional DATABASE_URL)

## Migration Path

1. Create `.env.local` from `env.local.example`
2. Add ONLY the secrets you need
3. Server will use `server_config.local.yaml` for behavioral config
4. `.env.local` secrets override YAML where needed

## File Summary

**Created**: `server/server_config.local.yaml` (local dev structural config)

**Created**: `env.local.example` (template for secrets)

**Existing**: `server/server_config.yaml` (production structural config)
- **Existing**: `server/server_config.e2e_test.yaml` (E2E test structural config)
- **User creates**: `.env.local` (your actual secrets, gitignored)
